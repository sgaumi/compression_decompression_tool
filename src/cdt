#!/bin/bash

''':'

result1=$(exec python3 --version 2>&1) ; ret1=$?
result2=$(exec python2 --version 2>&1) ; ret2=$?
	

if [ $ret1 -ne 0 ] ; then
	if [ $ret2 -ne 0 ] ; then	
		echo "Error : Not able to execute python3 or python2"
	else
		echo "script run using $result2"
		exec python2 "$0" "$@"
	fi
else
	echo "script run using $result1"
	exec python3 "$0" "$@"
fi
	
exit 0

':'''

import sys
import os.path
import struct


#### get file names ####

all_file=[]
if len(sys.argv)==1:
	while(len(all_file)==0):
		input_file=input("Enter file name(s) : ")
		index=[-1]
		for i in range(len(input_file)):
			if input_file[i]==' ':
				index.append(i)
		index.append(len(input_file))
		all_file=[]
		for i in range(len(index)-1):
			file_i=input_file[index[i]+1:index[i+1]]
			if(len(file_i)!=0):
				all_file.append(file_i)
else:
	for i in range(1,len(sys.argv)):
		all_file.append(sys.argv[i])

print(all_file) #test
	
########################

for i in range(len(all_file)):
	fname=all_file[i]
	if os.path.exists(fname)==False:
		print("file {} not found".format(fname))
	else:
		print("file {} found".format(fname))
		fr=open(fname,"rb")
		contenu=fr.read()
		print(contenu) #test
		fr.close()

		#things to do	
		
		fcreate=fname+".cdt"
		choice='a'
		if os.path.exists(fcreate):
			print("Warning : {} already exist. Do you allow the process to override it?".format(fcreate))
			while(choice!='y' and choice!='n'):
				choice=input("y : delete the file and process compression | n : keep the file and cancel compression (for this file only) : ")
			if choice=='y':
				fw=open(fcreate,"wb")
		else:	
			fw=open(fcreate,"xb")
		if choice!='n':
			fw.write(struct.pack("B",11)) #test
			fw.write(struct.pack("B",12)) #test
			fw.write(struct.pack("B",13)) #test
			fw.close()


